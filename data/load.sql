
/* INIT */
DROP DATABASE IF EXISTS election;
CREATE DATABASE election;
USE election;




/* DDL */
CREATE TABLE Candidate(
    CANDIDATE_ID INT PRIMARY KEY,
    CANDIDATE_NAME VARCHAR(256),
    PARTY VARCHAR(256)
);
CREATE TABLE County(
    FIPS VARCHAR(5) PRIMARY KEY,
    NAME VARCHAR(256),
    STATE VARCHAR(2)
);
CREATE TABLE Election(
    YEAR INT,
    FIPS VARCHAR(5), 
    CANDIDATE_ID INT,
    CANDIDATE_VOTES INT, 
    PRIMARY KEY(YEAR, FIPS, CANDIDATE_ID),
    FOREIGN KEY (FIPS) REFERENCES County(FIPS),
    FOREIGN KEY (CANDIDATE_ID) REFERENCES Candidate(CANDIDATE_ID)
);
CREATE TABLE Industry(
    INDUSTRY_ID INT PRIMARY KEY,
    NAME VARCHAR(256)
);
CREATE TABLE GDP(
    FIPS VARCHAR(5), 
    INDUSTRY_ID INT, 
    YEAR INT,
    GDP INT,
    PRIMARY KEY(FIPS, INDUSTRY_ID, YEAR),
    FOREIGN KEY (FIPS) REFERENCES County(FIPS),
    FOREIGN KEY (INDUSTRY_ID) REFERENCES Industry(INDUSTRY_ID)
);




/* LOAD DATA */
LOAD DATA LOCAL INFILE '~/output/candidate.csv' INTO TABLE Candidate 
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"';

LOAD DATA LOCAL INFILE '~/output/county.csv' INTO TABLE County
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"';

LOAD DATA LOCAL INFILE '~/output/industry.csv' INTO TABLE Industry
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"';

LOAD DATA LOCAL INFILE '~/output/gdp.csv' INTO TABLE GDP
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"';

LOAD DATA LOCAL INFILE '~/output/election.csv' INTO TABLE Election
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"';
